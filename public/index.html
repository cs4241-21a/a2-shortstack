<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
  </head>
  <body>
    <form action="" id = 'Form'>
     Name: <input type='text' id='yourname'> <br>
      Summoner Name: <input type="text" id ="sumname"><br>
      Rank: <input type ="text" id ="rank"><br>
      Primary Role:<select id ="prole" id="role">
      <option value="Top">Top</option>
      <option value="Jungle">Jungle</option>
      <option value="Middle">Middle</option>
      <option value="Bottom">Bottom</option>
      <option value="Support">Support</option>
      <option value="Fill">Fill</option>
    </select>
      <br>
      <button>submit</button>
    </form>
    <table id ="userTable">
        <thead>
        <tr>
            <th>Name</th>
            <th>Summoner Name</th>
            <th>Rank</th>
            <th>Primary Role</th>
            <th></th>
        </tr>
        </thead>
        <tbody id="data">

        </tbody>
    </table>
  </body>
  <script>

      function updateLeaderboard(leaderboard) {
          const holder = document.querySelector('#userTable');
          leaderboard.forEach((element, index) => {
              const row = document.createElement('tr');
              // Sign-up Name
              const userData = document.createElement('td');
              const userInput = document.createElement('input');
              userInput.className = 'table-input';
              userData.appendChild(userInput);
              userInput.value = element.yourName;
              userInput.id = `user-${index}`;

              // Summoner Name
              const summonerData = document.createElement('td');
              const summonerInput = document.createElement('input');
              summonerInput.className = 'table-input';
              summonerData.appendChild(summonerInput);
              summonerInput.value = element.summonerName;
              summonerInput.id = `description-${index}`;

              // Rank
              const rankData = document.createElement('td');
              const rankInput = document.createElement('input');
              rankInput.className = 'table-input';
              rankData.appendChild(rankInput);
              rankInput.value = element.rank;
              rankInput.id = `description-${index}`;


              // Primary Position
              const primaryRoleData = document.createElement('td');
              const primaryRoleInput = document.createElement('input');
              primaryRoleInput.className = 'table-input';
              primaryRoleData.appendChild(primaryRoleInput);
              primaryRoleInput.value = element.primaryRole;
              primaryRoleInput.id = `description-${index}`;


              row.appendChild(userData);
              row.appendChild(summonerData);
              row.appendChild(rankData);
              row.appendChild(primaryRoleData);

              holder.appendChild(row);
          });
      }

      const submit = function( e ) {
    // prevent default form action from being carried out
    e.preventDefault()
    const yourname = document.querySelector('#yourname');
    const rank = document.querySelector('#rank');
    const sumname = document.querySelector('#sumname');
    const prole = document.querySelector('#prole');
    const json = {yourName: yourname.value, rank: rank.value, summonerName: sumname.value, primaryRole: prole.value};
    const body = JSON.stringify(json);
    fetch( '/submit', {
      method:'POST',
      body 
    })
    .then( async function (response) {
        const leaderboard = await response.json();
        updateLeaderboard(leaderboard);
    })

    return false
  }

  window.onload = function() {
    const button = document.querySelector( 'button' )
    button.onclick = submit
  }

  </script>
</html>
